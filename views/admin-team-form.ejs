<%- include('admin-layout-top', { title: (member ? 'Edit Member' : 'New Member'), lang, useDb: true, active: 'team' }) %>
      <% if (member) { %>
        <div class="mb-3 rounded" style="background: linear-gradient(90deg, #7b2ff7 0%, #f107a3 100%); color:#fff;">
          <div class="d-flex justify-content-between align-items-center px-3 py-2">
            <div class="d-flex align-items-center">
              <i class="fas fa-user-edit me-2"></i>
              <strong>Editing Member</strong>
              <span class="ms-2 small" style="opacity:.85;">ID: <%= member.id %></span>
            </div>
            <a class="btn btn-light btn-sm" href="/admin/team?lang=<%= lang %>">← Back to Team</a>
          </div>
        </div>
      <% } else { %>
        <div class="mb-3 rounded" style="background: linear-gradient(90deg, #00c6ff 0%, #0072ff 100%); color:#fff;">
          <div class="d-flex justify-content-between align-items-center px-3 py-2">
            <div class="d-flex align-items-center">
              <i class="fas fa-user-plus me-2"></i>
              <strong>Creating New Member</strong>
            </div>
            <a class="btn btn-light btn-sm" href="/admin/team?lang=<%= lang %>">← Back to Team</a>
          </div>
        </div>
      <% } %>
      <% if (typeof error !== 'undefined' && error) { %>
        <div class="alert alert-danger"><i class="fas fa-exclamation-triangle me-2"></i><%= error %></div>
      <% } %>
      <form class="card p-3" method="post" enctype="multipart/form-data" action="<%= member ? '/admin/team/' + member.id + '?lang=' + lang : '/admin/team?lang=' + lang %>">
        <div class="mb-3">
          <label class="form-label" for="member_name">Name</label>
          <input id="member_name" class="form-control" type="text" name="name" value="<%= member ? member.name : '' %>" required />
        </div>
        <div class="mb-3">
          <label class="form-label" for="member_photo">Photo</label>
          <% if (member && member.photo_url) { %>
            <div class="mb-2 d-flex align-items-center gap-3">
              <img src="<%= member.photo_url.replace(/\.jpg$/, '-thumb.jpg') %>" onerror="this.src='<%= member.photo_url %>'" alt="Current photo" style="width:120px; height:120px; object-fit:cover; border-radius:8px; border:1px solid #eee;"/>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" name="remove_photo" value="1" id="remove_photo">
                  <label class="form-check-label" for="remove_photo">Remove photo</label>
                </div>
            </div>
          <% } %>
          <input id="member_photo" class="form-control" type="file" name="photo" accept="image/*" />
          <small class="text-muted d-block">Images only (JPG/PNG/GIF), maximum 2 MB. Leave empty to keep the current photo.</small>
        </div>

        <!-- Language tabs for Role and Bio -->
        <ul class="nav nav-tabs mb-3" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="tab-en" data-bs-toggle="tab" data-bs-target="#pane-en" type="button" role="tab">EN</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="tab-sk" data-bs-toggle="tab" data-bs-target="#pane-sk" type="button" role="tab">SK</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="tab-hu" data-bs-toggle="tab" data-bs-target="#pane-hu" type="button" role="tab">HU</button>
          </li>
        </ul>
        <% const tEn = (typeof membersByLang !== 'undefined' && membersByLang && membersByLang.en) || (member && member.lang==='en' ? member : {}) || {}; %>
        <% const tSk = (typeof membersByLang !== 'undefined' && membersByLang && membersByLang.sk) || (member && member.lang==='sk' ? member : {}) || {}; %>
        <% const tHu = (typeof membersByLang !== 'undefined' && membersByLang && membersByLang.hu) || (member && member.lang==='hu' ? member : {}) || {}; %>
        <div class="tab-content">
          <div class="tab-pane fade show active" id="pane-en" role="tabpanel">
            <div class="mb-3">
              <label class="form-label" for="role_en">Role (EN)</label>
              <input id="role_en" class="form-control" type="text" name="role_en" value="<%= tEn.role || '' %>" />
            </div>
            <div class="mb-3">
              <label class="form-label" for="bio_en">Bio (EN)</label>
              <textarea id="bio_en" class="form-control wysiwyg" name="bio_en" rows="6"><%= tEn.bio || '' %></textarea>
            </div>
          </div>
          <div class="tab-pane fade" id="pane-sk" role="tabpanel">
            <div class="mb-3">
              <label class="form-label" for="role_sk">Role (SK)</label>
              <input id="role_sk" class="form-control" type="text" name="role_sk" value="<%= tSk.role || '' %>" />
            </div>
            <div class="mb-3">
              <label class="form-label" for="bio_sk">Bio (SK)</label>
              <textarea id="bio_sk" class="form-control wysiwyg" name="bio_sk" rows="6"><%= tSk.bio || '' %></textarea>
            </div>
          </div>
          <div class="tab-pane fade" id="pane-hu" role="tabpanel">
            <div class="mb-3">
              <label class="form-label" for="role_hu">Role (HU)</label>
              <input id="role_hu" class="form-control" type="text" name="role_hu" value="<%= tHu.role || '' %>" />
            </div>
            <div class="mb-3">
              <label class="form-label" for="bio_hu">Bio (HU)</label>
              <textarea id="bio_hu" class="form-control wysiwyg" name="bio_hu" rows="6"><%= tHu.bio || '' %></textarea>
            </div>
          </div>
        </div>
        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label" for="linkedin">LinkedIn</label>
            <input id="linkedin" class="form-control" type="url" name="linkedin" value="<%= member ? (member.linkedin || '') : '' %>" placeholder="https://linkedin.com/in/..." />
          </div>
          <div class="col-md-4">
            <label class="form-label" for="facebook">Facebook</label>
            <input id="facebook" class="form-control" type="url" name="facebook" value="<%= member ? (member.facebook || '') : '' %>" placeholder="https://facebook.com/..." />
          </div>
          <div class="col-md-4">
            <label class="form-label" for="twitter">X (Twitter)</label>
            <input id="twitter" class="form-control" type="url" name="twitter" value="<%= member ? (member.twitter || '') : '' %>" placeholder="https://x.com/..." />
          </div>
        </div>
        <div class="mt-3 mb-3">
          <label class="form-label" for="sort_order">Sıra</label>
          <input id="sort_order" class="form-control" type="number" name="sort_order" value="<%= member ? (member.sort_order || 0) : 0 %>" />
         <small class="text-muted">Smaller number appears first.</small>
        </div>
        <button class="btn btn-primary" type="submit"><%= member ? 'Update' : 'Create' %></button>
      </form>
<%- include('admin-layout-bottom') %>
