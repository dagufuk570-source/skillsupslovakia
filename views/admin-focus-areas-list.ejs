<%- include('admin-layout-top', { title: 'Focus Areas', lang, useDb, active: 'focus-areas' }) %>
<div class="row g-3">
  <div class="col-12">
    <% if (success === 'created') { %><div class="alert alert-success">Focus area created.</div><% } %>
    <% if (success === 'updated') { %><div class="alert alert-success">Focus area updated.</div><% } %>
    <% if (success === 'deleted') { %><div class="alert alert-warning">Focus area deleted.</div><% } %>
    <div class="card wow fadeIn" data-wow-delay="0.1s">
      <div class="card-header text-white d-flex justify-content-between align-items-center" style="background-color:#1A685B;">
        <div class="d-flex align-items-center">
          <i class="fas fa-bullseye fa-lg me-2"></i>
          <h5 class="mb-0">Focus Areas</h5>
        </div>
        <a class="btn btn-light btn-sm text-dark" href="/admin/focus-areas/new?lang=<%= lang %>"><i class="fas fa-plus me-1"></i>New</a>
      </div>
      <div class="table-responsive">
        <table class="table table-striped align-middle">
          <thead>
            <tr>
              <% 
                const fixedCols = ['group','field','experts','description','activity_description','type_of_activity'];
                const colsArr = Array.isArray(cols) && cols.length ? cols : fixedCols;
                const labelsArr = (Array.isArray(labels) && labels.length) ? labels : ['Group','Field','Expert(s)','Description','Activity - Description','Type of activity'];
              %>
              <% labelsArr.forEach(lb => { %><th><%= lb %></th><% }) %>
              <th>Sort</th>
              <th>Published</th>
              <th style="width:140px;">Actions</th>
            </tr>
          </thead>
          <tbody>
            <% rows.forEach(r => { const f = r.fields || {}; %>
              <tr>
                <% colsArr.forEach(c => { %><td><%= f[c] || '' %></td><% }) %>
                <td><%= r.sort_order %></td>
                <td><span class="badge <%= r.published ? 'bg-success' : 'bg-secondary' %>"><%= r.published ? 'Yes' : 'No' %></span></td>
                <td>
                  <a class="btn btn-sm btn-outline-primary" href="/admin/focus-areas/<%= r.id %>/edit?lang=<%= lang %>"><i class="fas fa-edit"></i></a>
                  <form action="/admin/focus-areas/<%= r.id %>/delete?lang=<%= lang %>" method="post" class="d-inline" onsubmit="return confirm('Delete this item?');">
                    <button class="btn btn-sm btn-outline-danger" type="submit"><i class="fas fa-trash"></i></button>
                  </form>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  
</div>
<%- include('admin-layout-bottom') %>
