<%- include('layout-charitize', { title: event.title, lang, menu, slider, t }) %>

<div class="container-xxl py-5">
  <div class="container">
    <div class="row g-5">
      <div class="col-lg-8">
        <!-- Event Header -->
  <div class="mb-5 bg-white p-4 rounded">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="/?lang=<%= lang %>">Home</a></li>
              <li class="breadcrumb-item"><a href="/events?lang=<%= lang %>">Events</a></li>
              <li class="breadcrumb-item active" aria-current="page"><%= event.title %></li>
            </ol>
          </nav>
          <h1 class="display-5 mb-4"><%= event.title %></h1>
          <div class="d-flex align-items-center mb-3">
            <% if(event.event_date) { %>
              <span class="badge bg-primary me-3">
                <i class="fas fa-calendar me-1"></i>
                <%= new Date(event.event_date).toLocaleDateString() %>
              </span>
            <% } %>
            <% if(event.location) { %>
              <span class="badge bg-secondary">
                <i class="fas fa-map-marker-alt me-1"></i>
                <%= event.location %>
              </span>
            <% } %>
          </div>
        </div>

        <!-- Event Image -->
        <% if(event.image_url) { %>
          <div class="mb-5 bg-white p-4 rounded">
            <img src="<%= event.image_url %>" class="img-fluid rounded shadow" alt="<%= event.title %>">
          </div>
        <% } %>

        <!-- Event Content -->
        <div class="mb-5">
          <h3 class="mb-4">Event Details</h3>
          <div class="content lead">
            <% if(event.description) { %>
              <%- event.description %>
            <% } else { %>
              <p class="text-muted">No description available.</p>
            <% } %>
          </div>
        </div>

        <!-- Gallery Section -->
        <% if(additionalImages && additionalImages.length > 0) { %>
          <div class="mb-5">
            <h3 class="mb-4">Event Gallery</h3>
            <div class="row" id="event-gallery">
              <% additionalImages.forEach(function(image, index) { %>
                <div class="col-lg-4 col-md-6 mb-4">
                  <div class="card bg-light">
                    <img src="<%= image.image_url %>" class="card-img-top" alt="Gallery image <%= index + 1 %>" 
                         style="height: 200px; object-fit: cover;" 
                         data-bs-toggle="modal" 
                         data-bs-target="#imageModal<%= index %>"
                         role="button">
                  </div>
                </div>
                
                <!-- Modal for each image -->
                <div class="modal fade" id="imageModal<%= index %>" tabindex="-1" aria-labelledby="imageModalLabel<%= index %>" aria-hidden="true">
                  <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="imageModalLabel<%= index %>">Gallery Image <%= index + 1 %></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body text-center">
                        <img src="<%= image.image_url %>" class="img-fluid" alt="Gallery image <%= index + 1 %>">
                      </div>
                    </div>
                  </div>
                </div>
              <% }) %>
            </div>
          </div>
        <% } else { %>
          <div class="mb-5">
            <h3 class="mb-4">Event Gallery</h3>
            <div class="alert alert-info">
              <i class="fas fa-info-circle me-2"></i>
              No additional images available for this event.
            </div>
          </div>
        <% } %>
      </div>

      <!-- Sidebar -->
      <div class="col-lg-4">
        <div class="bg-light p-4 rounded">
          <h4 class="mb-4">Event Information</h4>
          
          <% if(event.event_date) { %>
            <div class="mb-3">
              <strong><i class="fas fa-calendar me-2 text-primary"></i>Date:</strong>
              <div class="ms-4"><%= new Date(event.event_date).toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
              }) %></div>
            </div>
          <% } %>
          
          <% if(event.location) { %>
            <div class="mb-3">
              <strong><i class="fas fa-map-marker-alt me-2 text-primary"></i>Location:</strong>
              <div class="ms-4"><%= event.location %></div>
            </div>
          <% } %>

          <% if(event.created_at) { %>
            <div class="mb-3">
              <strong><i class="fas fa-plus-circle me-2 text-primary"></i>Posted:</strong>
              <div class="ms-4"><%= new Date(event.created_at).toLocaleDateString() %></div>
            </div>
          <% } %>

          <div class="d-grid gap-2 mt-4">
            <a href="/events?lang=<%= lang %>" class="btn btn-outline-primary">
              <i class="fas fa-arrow-left me-2"></i>Back to Events
            </a>
            <% if(event.event_date && new Date(event.event_date) > new Date()) { %>
              <button class="btn btn-success" onclick="alert('Event registration will be available soon!')">
                <i class="fas fa-ticket-alt me-2"></i>Register for Event
              </button>
            <% } %>
          </div>
        </div>

        <!-- Event Status -->
        <div class="bg-light p-4 rounded mt-4">
          <h4 class="mb-3">Status</h4>
          <% if(event.event_date) { %>
            <% if(new Date(event.event_date) > new Date()) { %>
              <span class="badge bg-success fs-6">
                <i class="fas fa-clock me-1"></i>Upcoming
              </span>
            <% } else { %>
              <span class="badge bg-secondary fs-6">
                <i class="fas fa-check me-1"></i>Past Event
              </span>
            <% } %>
          <% } else { %>
            <span class="badge bg-warning fs-6">
              <i class="fas fa-question me-1"></i>Date TBD
            </span>
          <% } %>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include('layout-charitize-bottom') %>